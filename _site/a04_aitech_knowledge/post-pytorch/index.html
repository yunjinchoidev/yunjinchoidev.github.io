<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="ko" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Pytorch  - Reinvent love! - Democratization of Love</title>
<meta name="description" content="">


  <meta name="author" content="ìµœìœ¤ì§„">
  
  <meta property="article:author" content="ìµœìœ¤ì§„">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="ko_KR">
<meta property="og:site_name" content="Reinvent love! - Democratization of Love">
<meta property="og:title" content="Pytorch">
<meta property="og:url" content="http://localhost:4000/a04_aitech_knowledge/post-pytorch/">


  <meta property="og:description" content="">







  <meta property="article:published_time" content="2023-03-07T00:00:00+09:00">



  <meta property="article:modified_time" content="2023-03-08T06:20:02+09:00">



  

  


<link rel="canonical" href="http://localhost:4000/a04_aitech_knowledge/post-pytorch/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "ìì—°ì–´ ì²˜ë¦¬ ì—”ì§€ë‹ˆì–´ ë¸”ë¡œê·¸",
      "url": "http://localhost:4000/"
    
  }
</script>







<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Reinvent love! - Democratization of Love Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->
<link rel="apple-touch-icon" sizes="180x180" href="'../../../../assets/logo.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../../../assets/logo.png">
<link rel="icon" type="image/png" sizes="16x16" href="../../../../assets/logo.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="../../../../assets/logo.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
<link href="https://fonts.googleapis.com/css?family=Nanum+Serif+KR" rel="stylesheet" type="text/css">

<!-- end custom head snippets -->


    
  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          ì‚¬ë‘ì˜ ë°œëª… - NLPë¡œ ë§Œë“¤ì–´ê°€ëŠ” ì‚¬ë‘ì˜ ë¯¼ì£¼í™”
          <span class="site-subtitle">ìì—°ì–´ ì²˜ë¦¬ ì—”ì§€ë‹ˆì–´ ë¸”ë¡œê·¸</span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/about/">ReadMe</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/a03_aitech_weekly">AI Tech 5ê¸° íšŒê³ ë¡</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/a01_study">ê³µë¶€</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">í† ê¸€ ë©”ë‰´</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      





<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person" class="h-card">

  
    <div class="author__avatar">
      <a href="http://localhost:4000/">
        <img src="/image/profile/reinventoflove.png" alt="ìµœìœ¤ì§„" itemprop="image" class="u-photo">
      </a>
    </div>
  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="http://localhost:4000/" itemprop="url">ìµœìœ¤ì§„</a>
    </h3>
    
      <div class="author__bio p-note" itemprop="description">
        <p>ë°˜ê°‘ìŠµë‹ˆë‹¤. ê°™ì´ ì‚¬ë‘ì´ë¼ëŠ” ê°ì •ì„ ë°œëª…í•´ë³´ì•„ìš”.</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">íŒ”ë¡œìš°</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name" class="p-locality">Republic of Korea</span>
        </li>
      

      
        
          
            <li><a href="yunjinchoidev@gmail.com" rel="nofollow noopener noreferrer me"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">G-mail</span></a></li>
          
        
          
            <li><a href="https://github.com/yunjinchoidev" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
            <li><a href="https://www.youtube.com/channel/UC7B4c49J4XFzoety13KYuDg" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-youtube" aria-hidden="true"></i><span class="label">8ê¸°í†µ ì—”ì§„ ì±„ë„</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  

  
    <!--ì „ì²´ ê¸€ ìˆ˜ë¥¼ ì„¸ê¸° ìœ„í•œ ì—°ì‚°. sum ë³€ìˆ˜ì— ì „ì²´ ê¸€ ìˆ˜ ì €ì¥-->



<nav class="nav__list">
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">í† ê¸€ ë©”ë‰´</label>
  <ul class="nav__items" id="category_tag_menu">
      <!--ì „ì²´ ê¸€ ìˆ˜-->
      <li>
            ğŸ“‚ <span style="font-family:'Cafe24Oneprettynight';">ì „ì²´ ê¸€ ìˆ˜</style> <span style="font-family:'Coming Soon';">65</style> <span style="font-family:'Cafe24Oneprettynight';">ê°œ</style> 
      </li>
      <li>

        <span class="nav__sub-title"> ğŸ“Œ ê³µë¶€ </span>
            <ul>
                
                    
                
                    
                
                    
                
                    
                
            </ul>



        <!--span íƒœê·¸ë¡œ ì¹´í…Œê³ ë¦¬ë“¤ì„ í¬ê²Œ ë¶„ë¥˜ ex) C/C++/C#-->
        <span class="nav__sub-title">  ğŸ“Œ AI Tech 5ê¸°</span>
            <!--ul íƒœê·¸ë¡œ ê°™ì€ ì¹´í…Œê³ ë¦¬ë“¤ ëª¨ì•„ë‘” í˜ì´ì§€ë“¤ ë‚˜ì—´-->
            <ul>
                <!--Cpp ì¹´í…Œê³ ë¦¬ ê¸€ë“¤ì„ ëª¨ì•„ë‘” í˜ì´ì§€ì¸ /categories/cpp ì£¼ì†Œì˜ ê¸€ë¡œ ë§í¬ ì—°ê²°-->
                <!--category[1].size ë¡œ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ë¥¼ ê°€ì§„ ê¸€ì˜ ê°œìˆ˜ í‘œì‹œ--> 


                
                    
                
                    
                        <li><a href="/categories/aitech_daily" class="">ë°ì¼ë¦¬ ë¦¬ë·° (10)</a></li>
                    
                
                    
                
                    
                

                
                    
                        <li><a href="/categories/aitech_weekly" class="">ìœ„í´ë¦¬ ë¦¬ë·° (12)</a></li>
                    
                
                    
                
                    
                
                    
                                                

                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/aitech_knowledge" class="">í•™ìŠµ (17)</a></li>
                    
                

            </ul>





      </li>
  </ul>
</nav>
  
  
  
  </div>



  <article class="page h-entry" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Pytorch">
    <meta itemprop="description" content="">
    <meta itemprop="datePublished" content="2023-03-07T00:00:00+09:00">
    <meta itemprop="dateModified" content="2023-03-08T06:20:02+09:00">

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title p-name" itemprop="headline">
            <a href="http://localhost:4000/a04_aitech_knowledge/post-pytorch/" class="u-url" itemprop="url">Pytorch
</a>
          </h1>
          

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          5 ë¶„ ì†Œìš”
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content e-content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> ëª©ì°¨</h4></header>
              <ul class="toc__menu"><li><a href="#-introduction-to-pytorch">âœ… Introduction to PyTorch</a><ul><li><a href="#íŒŒì´í† ì¹˜-api">íŒŒì´í† ì¹˜ API</a></li><li><a href="#ê³µì‹ë¬¸ì„œë¥¼-ì½ìì‹œë‹¤">ê³µì‹ë¬¸ì„œë¥¼ ì½ìì‹œë‹¤.</a></li><li><a href="#dynamic-graph">Dynamic graph</a></li></ul></li><li><a href="#--dive-to-pytorch">âœ…  Dive To Pytorch</a><ul><li><a href="#torchview">torch.view</a></li><li><a href="#tochsqueeze">toch.squeeze</a></li><li><a href="#torchunsqueeze">torch.unsqueeze</a></li><li><a href="#torchindex_select">TORCH.INDEX_SELECT</a></li><li><a href="#torchswapdims">torch.swapdims</a></li><li><a href="#torchrandn">torch.randn</a></li></ul></li><li><a href="#torchlog1p">TORCH.LOG1P</a><ul><li><a href="#torchprod">TORCH.PROD</a></li><li><a href="#torchcount_nonzero">TORCH.COUNT_NONZERO</a></li><li><a href="#squeeze-unsqueeze">squeeze(), unsqueeze()</a></li><li><a href="#mm-matmul">mm(), matmul</a></li><li><a href="#autograd">autograd</a></li><li><a href="#ì—¬ê¸°ì„œ-ì ê¹-">ì—¬ê¸°ì„œ ì ê¹ !</a></li></ul></li><li><a href="#-use-template">âœ… Use Template</a></li><li><a href="#-autograd--optimizer">âœ… AutoGrad &amp; Optimizer</a></li><li><a href="#-ë°ì´í„°ë¥¼-ë¶ˆëŸ¬ì˜¤ì-dataset--dataloader">âœ… [ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ì~] Dataset &amp; Dataloader</a><ul><li><a href="#pytorch-dataset">Pytorch Dataset</a></li><li><a href="#pytorch-dataloader">Pytorch Dataloader</a></li></ul></li><li><a href="#-save-model-ëª¨ë¸ì„-ì €ì¥í•˜ê³ -ë¶ˆëŸ¬ì˜¤ê¸°">âœ… [Save Model] ëª¨ë¸ì„ ì €ì¥í•˜ê³  ë¶ˆëŸ¬ì˜¤ê¸°</a><ul><li><a href="#check-point">check point</a></li><li><a href="#ì „ì´í•™ìŠµê³¼-ë¶ˆëŸ¬ì˜¤ê¸°">ì „ì´í•™ìŠµê³¼ ë¶ˆëŸ¬ì˜¤ê¸°</a></li><li><a href="#freezing">Freezing</a></li></ul></li><li><a href="#-ëª¨ë‹ˆí„°ë§-í•©ì‹œë‹¤---monitoring-tools-for-pytorch">âœ… ëª¨ë‹ˆí„°ë§ í•©ì‹œë‹¤ - Monitoring tools for PyTorch</a></li><li><a href="#-muti-gpu">âœ… Muti-GPU</a></li><li><a href="#-hyperparameter-tuning">âœ… Hyperparameter Tuning</a></li><li><a href="#-pytorch-troubleshooting">âœ… PyTorch Troubleshooting</a></li></ul>

            </nav>
          </aside>
        
        <p><img src="../../../image/aitech.png" alt="image" /></p>

<h1 id="-introduction-to-pytorch">âœ… Introduction to PyTorch</h1>
<p>íŒŒì´í† ì¹˜ë¥¼ ê³µë¶€í•©ì‹œë‹¤. <code class="language-plaintext highlighter-rouge">ë„¤íŠ¸ì›Œí¬ êµ¬í˜„ ë° ë°ì´í„° ë¡œë”©, í”„ë¡œì íŠ¸ êµ¬ì¡°, ë¡œê¹…, Multi GPU, ì´ì–´ í•™ìŠµ</code> ì„ ë‹¤ë£¹ë‹ˆë‹¤.</p>

<p>ë°‘ë°”ë‹¥ë¶€í„° ë”¥ëŸ¬ë‹ ì½”ë“œ ì§œê¸°ë¥¼ ì§¤ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. <a href="https://www.aladin.co.kr/shop/wproduct.aspx?ItemId=256067157&amp;start=slayer">ì±… ì½ì–´ë³´ì„¸ìš”.</a></p>

<p>í•˜ì§€ë§Œ ì €í¬ëŠ” ë”¥ëŸ¬ë‹ í”„ë ˆì„ì›Œí¬ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ì„œ í…ì„œí”Œë¡œì™€ íŒŒì´í† ì¹˜ê°€ ìˆìŠµë‹ˆë‹¤. í…ì„œí”Œë¡œëŠ” êµ¬ê¸€ì—ì„œ ë§Œë“¤ì—ˆê³ , íŒŒì´í† ì¹˜ëŠ” í˜ì´ìŠ¤ë¶ì—ì„œ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤.</p>

<p>ì €í¬ëŠ” íŒŒì´í† ì¹˜ë¥¼ ì‚¬ìš©í•  ê²ƒì…ë‹ˆë‹¤. íŒŒì´í† ì¹˜ëŠ” ì¥ì ì´ ê½¤ ë§ìŠµë‹ˆë‹¤. ëŒ€í‘œì ìœ¼ë¡œ Define by Run ì´ë¼ëŠ” ì‘ë™ ë°©ì‹ì¸ë°ìš”. ì´ê²ƒì€ ì‹¤í–‰ì„ í•œë©´ì„œ ê³„ì‚° ê·¸ë˜í”„(Computational Graph)ë¥¼ ìƒì„±í•˜ëŠ” ê²ƒì„ ë§í•©ë‹ˆë‹¤. <strong>ë°˜ë©´</strong> í…ì„œí”Œë¡œëŠ” Define by Run ì´ë¼ê³  í•´ì„œ ê·¸ë˜í”„ë¥¼ ë¨¼ì € ì •ì˜í•˜ëŠ” ë°©ì‹ì…ë‹ˆë‹¤. íŒŒì´í† ì¹˜ëŠ” í•™íšŒ, ë…¼ë¬¸ì— ê°•ì ì„ ê°€ì§€ê³  ìˆìœ¼ë©° í…ì„œí”Œë¡œëŠ” ì‹¤ë¬´(í”„ë¡œë•ì…˜)ì— ê°•ì ì„ ê°€ì§€ê³  ìˆë‹¤ê³  í•  ìˆ˜ ìˆì£ . ê·¸ë¦¬ê³  íŒŒì´í† ì¹˜ëŠ” ì¦‰ì‹œ ë”¥ëŸ¬ë‹ ì½”ë“œê°€ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸ì„ í•  ìˆ˜ê°€ ìˆìœ¼ë©° <code class="language-plaintext highlighter-rouge">numpy, autograd, function</code> ì˜ ê¸°ëŠ¥ì„ ëª¨ë‘ ì œê³µí•©ë‹ˆë‹¤.</p>

<p>íŒŒì´í† ì¹˜ì˜ ì˜í–¥ë ¥ì€ ì ì  ë” ì»¤ì ¸ê°€ê³  ìˆìŠµë‹ˆë‹¤. í…ì„œí”Œë¡œì˜ ì ìœ ìœ¨ì„ ë„˜ì–´ì„°ì£ . íŒŒì´í† ì¹˜ë¡œ í•´ë´…ì‹œë‹¤. pytorchëŠ” í•œ ë§ˆë””ë¡œ <code class="language-plaintext highlighter-rouge">numpy, autograd, function</code> ì…ë‹ˆë‹¤. í•œ ë§ˆë””ë¡œ ë¯¸ë¶„ì„ ì§€ì›í•˜ëŠ” í”„ë ˆì„ì›Œí¬ë¼ê³  í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Q. Tensorflow ì™€ Pytorchì˜ ì°¨ì´ì ì€ ?
Tensorflow ëŠ” Define and Run ì´ë‹¤.
Pytorch ëŠ” Dynamic Computation Graph ë‹¤.
</code></pre></div></div>

<h2 id="íŒŒì´í† ì¹˜-api">íŒŒì´í† ì¹˜ API</h2>
<p>íŒŒì´í† ì¹˜ API ë¥¼ ì•Œì•„ë´…ì‹œë‹¤.</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">torch</code> : í…ì„œ ë“±ì˜ ë‹¤ì–‘í•œ ìˆ˜í•™ í•¨ìˆ˜ê°€ í¬í•¨</li>
  <li><code class="language-plaintext highlighter-rouge">torch.autograd</code> : ìë™ ë¯¸ë¶„ì„ ìœ„í•œ í•¨ìˆ˜ë“¤ì´ í¬í•¨</li>
  <li><code class="language-plaintext highlighter-rouge">torch.nn</code> : ì‹ ê²½ë§ì„ êµ¬ì¶•í•˜ê¸° ìœ„í•œ ë‹¤ì–‘í•œ ë°ì´í„° êµ¬ì¡°ë‚˜ ë ˆì´ì–´ ë“±ì´ ì •ì˜</li>
  <li><code class="language-plaintext highlighter-rouge">torch.multiprocessing</code> : í™•ë¥ ì  ê²½ì‚¬ í•˜ê°•ë²•(Stochastic Gradient Descent, SGD)ë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ í•œ íŒŒë¼ë¯¸í„° ìµœì í™” ì•Œê³ ë¦¬ì¦˜ì´ êµ¬í˜„</li>
  <li><code class="language-plaintext highlighter-rouge">torch.utils</code></li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
</code></pre></div></div>
<p>íŒŒì´í† ì¹˜ëŠ” í…ì„œë¡œ ì‹œì‘í•´ì„œ í…ì„œë¡œ ëë‚©ë‹ˆë‹¤.</p>

<h2 id="ê³µì‹ë¬¸ì„œë¥¼-ì½ìì‹œë‹¤">ê³µì‹ë¬¸ì„œë¥¼ ì½ìì‹œë‹¤.</h2>
<p>ê³µì‹ë¬¸ì„œê°€ êµ‰ì¥íˆ ì¤‘ìš”í•©ë‹ˆë‹¤. ìš°ë¦¬ ê°™ì´ ì½ì–´ë´ìœ .
<a href="https://pytorch.org/docs/stable/index.html">[ê³µì‹ë¬¸ì„œ ë°”ë¡œê°€ê¸°]</a></p>

<h2 id="dynamic-graph">Dynamic graph</h2>
<p><a href="https://www.reddit.com/r/pytorch/comments/8kpsjy/can_someone_explain_the_use_of_a_dynamic_graph/">ì¶œì²˜ ë°”ë¡œê°€ê¸°</a></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
if/then/elseì™€ ê°™ì€ ì¼ë°˜ì ì¸ ì œì–´ íë¦„ì„ ì‚¬ìš©í•˜ê³  ì—¬ì „íˆ ì—­ì „íŒŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.


ë™ì  ê·¸ë˜í”„ì˜ ì£¼ìš” ì´ì ì€ ê°€ë³€ ì‹œí€€ìŠ¤ ê¸¸ì´ë¥¼ ê°€ì§„ ìˆœí™˜ ì‹ ê²½ë§ì— ëŒ€í•œ ê²ƒì…ë‹ˆë‹¤.
 ì •ì  ê·¸ë˜í”„ëŠ” ê·¸ê²ƒë“¤ì„ ê¹”ë”í•˜ê²Œ ì²˜ë¦¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
 ê°€ì¥ í° ì‹œí€€ìŠ¤ë¥¼ ë¨¼ì € ë„£ì–´ì•¼ í•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. 
 ë‹¨, í…ìŠ¤íŠ¸ì—ëŠ” ì‘ë™í•˜ì§€ ì•Šê³  ë¬¸ì¥ì„ ì „í™˜í•  ìˆ˜ ì—†ìœ¼ë¯€ë¡œ ê°€ëŠ¥í•œ 
 ê°€ì¥ ê¸´ ë¬¸ì¥ì„ ìœ„í•œ ê³µê°„ì„ í™•ë³´í•´ì•¼ í•©ë‹ˆë‹¤.


The main advantage of dynamic graphs is for recurrent neural nets with variable sequence lengths. Static graphs just can't deal with them cleanly, because you have to put the biggest sequence first, except that wouldn't work for text, you can't just switch sentences, so you reserve space for the longest possible sentence.

Another advantage is the autograd, when creating custom layers dynamic frameworks all have automatic differentiation so you don't need to write the backward pass, writing the backward pass of LSTM or GRU is quite tricky and easy to get wrong.

Now every framework has an autograd so that's not relevant.

The last and biggest is that with dynamic frameworks you are writing Python and functions/control-flow compose like Python. Typical examples are:

you can use for loops, you're not forced to use "scan" (because Python for loops are not known at compile-time).

you can use normal control flow like if/then/else and still backprop through it.
</code></pre></div></div>

<p><br />
<br />
<br />
<br /></p>

<h1 id="--dive-to-pytorch">âœ…  Dive To Pytorch</h1>
<p>ì´ì œ íŒŒì´í† ì¹˜ ê¸°ë³¸ì— ëŒ€í•´ì„œ ê³µë¶€í•´ ë´…ì‹œë‹¤. 
íŒŒì´í† ì¹˜ëŠ” numpyì™€ ì™ ë§Œí•œ ë¬¸ë²•ì´ ë¹„ìŠ·í•˜ë‹ˆ numpyë¥¼ ì˜ í•˜ì‹œë©´ ì–´ëŠì •ë„ëŠ” ì˜ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë¶€ì¡±í•˜ë‹¤ê³  ëŠë¼ë©´ numpyë¥¼ ê³µë¶€í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤. ê·¸ë˜ë„ ì¤‘ìš”í•œ ê²ƒ ëª‡ ê°€ì§€ë§Œ ì •ë¦¬í•´ ë´…ì‹œë‹¤.</p>

<h2 id="torchview">torch.view</h2>
<p>ì›ì†Œì˜ ìˆ˜ë¥¼ ìœ ì§€í•˜ë©´ì„œ í…ì„œì˜ í¬ê¸°ë¥¼ ë³€ê²½í•˜ëŠ” í•¨ìˆ˜</p>

<h2 id="tochsqueeze">toch.squeeze</h2>
<p>1ì¸ ì°¨ì›ì„ ì œê±°í•œë‹¤.</p>

<h2 id="torchunsqueeze">torch.unsqueeze</h2>
<p>íŠ¹ì • ìœ„ì¹˜ì— 1ì¸ ì°¨ì›ì„ ì¶”ê°€í•œë‹¤.</p>

<p>ì´ ì™¸ì—ë„ ìˆ˜ë§ì€ ê¸°ëŠ¥ë“¤ì´ íŒŒì´í† ì¹˜ì— ë‹´ê²¨ ìˆìŠµë‹ˆë‹¤. íŒŒì´í† ì¹˜ë¥¼ ì˜ í•˜ê¸° ìœ„í•œ ë¹„ê²°ì€ ë¬´ì—‡ì¼ê¹Œìš”? ê³µì‹ë¬¸ì„œë¥¼  íƒìƒ‰í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. dl ì½”ë“œë¥¼ ì§¤ ë•Œë„ ë§ˆì°¬ê°€ì§€ ì…ë‹ˆë‹¤. í•´ë‹¹ í•¨ìˆ˜, ë¼ì´ë¸Œë¼ë¦¬ê°€ ì‹¤ì œë¡œ ì½”ë“œ ë ˆë²¨ì—ì„œ ì–´ë–»ê²Œ êµ¬í˜„ ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•˜ëŠ” ìŠµê´€ì„ ë“¤ì…ì‹œë‹¤.</p>

<h2 id="torchindex_select">TORCH.INDEX_SELECT</h2>

<h2 id="torchswapdims">torch.swapdims</h2>

<h2 id="torchrandn">torch.randn</h2>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&gt;&gt;&gt; torch.randn(4)
tensor([-2.1436,  0.9966,  2.3426, -0.6366])
&gt;&gt;&gt; torch.randn(2, 3)
tensor([[ 1.5954,  2.8929, -1.0923],
        [ 1.1719, -0.4709, -0.1996]])
</code></pre></div></div>

<h1 id="torchlog1p">TORCH.LOG1P</h1>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&gt;&gt;&gt; a = torch.randn(5)
&gt;&gt;&gt; a
tensor([-1.0090, -0.9923,  1.0249, -0.5372,  0.2492])
&gt;&gt;&gt; torch.log1p(a)
tensor([    nan, -4.8653,  0.7055, -0.7705,  0.2225])
</code></pre></div></div>

<h2 id="torchprod">TORCH.PROD</h2>
<p>ëª¨ì€ í…ì„œ ì„±ë¶„ì˜ ê³±</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&gt;&gt;&gt; a = torch.randn(1, 3)
&gt;&gt;&gt; a
tensor([[-0.8020,  0.5428, -1.5854]])
&gt;&gt;&gt; torch.prod(a)
tensor(0.6902)
</code></pre></div></div>

<h2 id="torchcount_nonzero">TORCH.COUNT_NONZERO</h2>
<p>Counts the number of non-zero values in the tensor input along the given dim. If no dim is specified then all non-zeros in the tensor are counted.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&gt;&gt;&gt; x = torch.zeros(3,3)
&gt;&gt;&gt; x[torch.randn(3,3) &gt; 0.5] = 1
&gt;&gt;&gt; x
tensor([[0., 1., 1.],
        [0., 0., 0.],
        [0., 0., 1.]])
&gt;&gt;&gt; torch.count_nonzero(x)
tensor(3)
&gt;&gt;&gt; torch.count_nonzero(x, dim=0)
tensor([0, 1, 2])
</code></pre></div></div>

<p>pytorchëŠ” gpuì— ì˜¬ë ¤ì„œ ì‘ì—…ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. ì•„ë˜ëŠ” pytorchë¥¼ gpuì— ì˜¬ë¦´ì§€ ì‘ì—…í•˜ëŠ” ì½”ë“œì´ë‹ˆ ì˜ ìˆ™ì§€í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>x_data.device

if  torch.cuda.is_available():
    x_data_cuda = x_data.to('cuda')
x_data_cuda.device

</code></pre></div></div>

<h2 id="squeeze-unsqueeze">squeeze(), unsqueeze()</h2>

<h2 id="mm-matmul">mm(), matmul</h2>
<p>mmê³¼ matmulì€ broadcasting ì„ ì§€ì›í•©ë‹ˆë‹¤.</p>

<h2 id="autograd">autograd</h2>
<p>autograd ì— ëŒ€í•´ì„œ ê³µë¶€í•´ë´…ì‹œë‹¤. 
ì•„ë˜ ì½”ë“œëŠ” íŒŒì´í† ì¹˜ë¥¼ í†µí•´ ì˜¤ì°¨ ì—­ì „íŒŒë¥¼ ê³„ì‚°í•˜ëŠ” ì‹ì…ë‹ˆë‹¤.
backward ë¼ëŠ” í•¨ìˆ˜ëŠ” ì—°ì‡„ë²•ì¹™ì„ ì ìš©ì‹œì¼œ ì—­ì „íŒŒë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤.
ê·¸ëŸ¬ë©´ ìì—°ìŠ¤ë˜ w.grad ê°’ì„ êµ¬í•  ìˆ˜ ìˆê² ì£ .</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>w = torch.tensor(2.0, requires_grad=True)
y = w**2
z = 10*y + 25
z.backward()
w.grad

&gt; z.backward() ë¥¼ í†µí•´ ì˜¤ì°¨ì—­ì „íŒŒë¥¼ ê³„ì‚°
&gt; w.grad ë¥¼ í†µí•´ z ì— ëŒ€í•œ w ê·¸ë ˆë””ì–¸íŠ¸ ì¶”ì¶œ
</code></pre></div></div>

<h2 id="ì—¬ê¸°ì„œ-ì ê¹-">ì—¬ê¸°ì„œ ì ê¹ !</h2>
<blockquote>
  <p>ìµœëŒ€ê°€ëŠ¥ë„ ì¶”ì •ë²•ì´ë€ ë­˜ê¹Œìš”? ê´€ì°°ëœ ë°ì´í„°ê°€ ì–´ë– í•œ ëª¨ìˆ˜ë¡œë¶€í„° ë‚˜ì™”ì„ ê°€ëŠ¥ì„±ì´ ê°€ì¥ ë†’ì€ì§€ë¥¼ ì¶”ì •í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤. ëª¨ìˆ˜ë€ ë¬´ì—‡ì¼ê¹Œìš”? ëª¨ìˆ˜ëŠ” ëª¨ì§‘ë‹¨ì˜ íŠ¹ì„±(ëª¨í‰ê· ,ëª¨ë¶„ì‚° ë“±..)ì„ ë‚˜íƒ€ë‚´ëŠ” ê°’ìœ¼ë¡œ, ì´ ê°’ì„ ëª¨ì§‘ë‹¨ì„ ì „ìˆ˜ì¡°ì‚¬í•´ì•¼ë§Œ ì•Œìˆ˜ìˆëŠ” ê°’ì…ë‹ˆë‹¤. ì‹¤ì§ˆì ìœ¼ë¡œ ëª¨ì§‘ë‹¨ì˜ í¬ê¸°ì™€ ë²”ìœ„ê°€ ë„ˆë¬´ ë°©ëŒ€í•˜ê¸°ì— ì „ìˆ˜ì¡°ì‚¬ë¥¼ ì‹¤ì‹œí•˜ì§€ ì•Šê³  í‘œë³¸ì¡°ì‚¬ë¥¼ í•˜ëŠ”ë° í‘œë³¸í‰ê· ,í‘œë³¸ë¶„ì‚° ë“±ìœ¼ë¡œ ëª¨í‰ê· , ëª¨ë¶„ì‚°ë“±ì„ ì¶”ì •í• ìˆ˜ê°€ ìˆìŠµë‹ˆë‹¤.</p>
</blockquote>

<p><br />
<br />
<br />
<br /></p>

<h1 id="-use-template">âœ… Use Template</h1>
<p>ì—¬ëŸ¬ë¶„ì€ ì–¸ì œê¹Œì§€ ì½”ë©ì„ ì“°ì‹¤ ìƒê°ì…ë‹ˆê¹Œ? í…œí”Œë¦¿ì„ ì”ì‹œë‹¤. ê³ ìˆ˜ê°€ ë˜ëŠ” ì§€ë¦„ê¸¸ì´ì£ . ìš°ë¦¬ëŠ” ë¯¸ë˜ë¡œ ê°€ì•¼í•©ë‹ˆë‹¤. í…œí”Œë¦¿ì„ ì‚¬ìš©í•¨ìœ¼ë¡œì¨ ìš°ë¦¬ëŠ” ê·¸ ë¯¸ë˜ë¡œ ê°ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤. <code class="language-plaintext highlighter-rouge">ì‹¤í–‰, ë°ì´í„°, ëª¨ë¸,  ì„¤ì •, ë¡œê¹…, ì§€í‘œ, ìœ í‹¸ë¦¬í‹°</code> ì´ ëŒ€í‘œì ì´ì£ .
ë‹¤ìŒ ì˜¤í”ˆ ì†ŒìŠ¤ì—ì„œ íŒŒì´í† ì¹˜ í…œí”Œë¦¿ì„ ë‹¤ìš´ ë°›ê³  ë©´ë°€í•˜ê²Œ ë¶„ì„í•´ë³´ì„¸ìš”. ë©´ë°€í•˜ê²Œ ë¶„ì„ì„ í•´ë´…ì‹œë‹¤. <a href="https://github.com/victoresque/pytorch-template">ë§í¬</a>
ì½”ë”© ëŠ¥ë ¥ì´ ë§ì´ í•„ìš”í•˜ë‹¤ëŠ” ê²ƒì„ ë¶„ëª… ëŠë¼ì…¨ì„ ê²ë‹ˆë‹¤. ì½”ë”© ì—­ëŸ‰ì„ ê¸°ë¥´ì‹­ì‹œì˜¤.</p>

<p><br />
<br />
<br />
<br /></p>

<h1 id="-autograd--optimizer">âœ… AutoGrad &amp; Optimizer</h1>
<p>ë…¼ë¬¸ì„ í•œ ë²ˆ êµ¬í˜„í•´ë´…ì‹œë‹¤.
ë”¥ëŸ¬ë‹ì´ë€ layerë¥¼ ìŒ“ê³  ë ˆê³  ë¸”ëŸ­ì„ ìŒ“ëŠ” ì¼ë ¨ì˜ ê³¼ì •ì´ë¼ê³  í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. input, output, forward, backwardê°€ ë³µì¡í•œ ìƒí˜¸ì‘ìš©ì„ ê°€ì§€ê³  ìˆëŠ” ê²ƒì´ì£ .</p>
<ul>
  <li>torch.nn.Module í´ë˜ìŠ¤
    <ul>
      <li>ì´ ëª¨ë“ˆì€ ê¸°ë³¸ì ì¸ input, output, forward, backward êµ¬í˜„ì„ ì§€ì›í•©ë‹ˆë‹¤.</li>
    </ul>
  </li>
  <li>torch.nn.Parameter
    <ul>
      <li>required_grad=True ì˜µì…˜ì„ ì¤˜ì•¼ gradient ê°€ ìµœì‹ í™” ë©ë‹ˆë‹¤.</li>
    </ul>
  </li>
</ul>

<p>íŒŒì´í† ì¹˜ë¥¼ ì‚¬ìš©í•¨ìœ¼ë¡œì¨ ìš°ë¦¬ëŠ” backward í•¨ìˆ˜ë¥¼ ì§ì ‘ êµ¬í˜„í•  ì¼ì€ ì—†ìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ì‹¤ì œ ì–´ë–»ê²Œ ì‘ë™í•˜ê³  ìˆëŠ”ì§€ ë¶„ëª…í•˜ê²Œ ì´í•´í•  í•„ìš”ê°€ ìˆìŠµë‹ˆë‹¤.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import torch
from torch.autograd import Variable

class LinearRegression(torch.nn.Module):
    def __init__(self, inputSize, outputSize):
        super(LinearRegression, self).__init__()

        ## í† ì¹˜ê°€ linerë¥¼ êµ¬í˜„í•´ì¤¬ë‹¤.
        ## ì½”ë“œ ë ˆë²¨ì—ì„œ ì§ì ‘ ë³´ì‹œë¼.
        self.linear = torch.nn.Linear(inputSize, outputSize)

    def forward(self, x):
        out = self.linear(x)
        return out
    
inputDim = 1
outputDim = 1
learningRate = 0.01
epochs = 100

model = LinearRegression(inputDim, outputDim)

# ëª¨ë¸ í•™ìŠµ ì‹œí‚¬ ë•Œ ì¿ ë‹¤ ë„£ê¸°
if torch.cuda.is_available():
    model.cuda()


criterion = torch.nn.MSELoss()
optimizer = torch.optim.SGD(model.parameters(), lr=learningRate)


# ì—í¬í¬ë¥¼ ëŒë¦¬ë€ ë§ì´ì—¬!! 
for epochs in range(epochs):
    if torch.cuda.is_available():
        inputs = Variable(torch.from_numpy(x_train).cuda())
        labels = Variable(torch.from_numpy(y_train).cuda())
    else:
        inputs = Variable(torch.from_numpy(x_train))
        lables = Variable(torch.from_numpy(y_train))

    # ì´ê±¸ í•´ì¤˜ì•¼ í•œë‹¤.
    optimizer.zero_grad()

    ## ëŒë ¤ëŒë ¤ 
    outputs = model(inputs)


    ## ìš”ê²ƒì´ ì†ì‹¤í•¨ìˆ˜ë‹¤!
    loss = criterion(outputs, lables)

    # ì˜¤ì¼€ì´. ê²½ì‚¬í•˜ê°•ë²•!
    loss.backward()

    # ì˜¤ì°¨ì—­ì „íŒŒ ì ìš© -&gt; ì˜µí‹°ë§ˆì´ì €
    optimizer.step()


    print('epochs {}, loss {}'.format(epochs, loss.item()))


Output exceeds the size limit. Open the full output data in a text editor
epochs 0, loss 0.0023449501022696495
epochs 1, loss 0.0023187585175037384
epochs 2, loss 0.002292879391461611
epochs 3, loss 0.0022672710474580526
epochs 4, loss 0.0022419483866542578
epochs 5, loss 0.002216903492808342
epochs 6, loss 0.002192169427871704
epochs 7, loss 0.002167687052860856
epochs 8, loss 0.002143467077985406
epochs 9, loss 0.0021195358131080866
epochs 10, loss 0.0020958760287612677
epochs 11, loss 0.0020724674686789513
epochs 12, loss 0.0020493241026997566
epochs 13, loss 0.002026451053097844
epochs 14, loss 0.002003807807341218
epochs 15, loss 0.001981443725526333
epochs 16, loss 0.0019593113102018833
epochs 17, loss 0.0019374340772628784
epochs 18, loss 0.0019157928181812167
epochs 19, loss 0.0018943949835374951
epochs 20, loss 0.0018732366152107716
epochs 21, loss 0.0018523228354752064
epochs 22, loss 0.0018316390924155712
epochs 23, loss 0.0018111761892214417
epochs 24, loss 0.001790948212146759
...
epochs 95, loss 0.0008068863535299897
epochs 96, loss 0.0007978747016750276
epochs 97, loss 0.0007889581611379981
epochs 98, loss 0.0007801674073562026

</code></pre></div></div>

<ul>
  <li>ì½”ë“œë ˆë²¨ì—ì„œ ë³´ëŠ” ìŠµê´€ì„ ë“¤ì—¬ë³´ì„¸ìš”.</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>optimizer.zero_grad() ë¥¼ ì•ˆì“°ë©´ ì–´ë–»ê²Œ ë ê¹Œ?
- gradient ê°€ ì´ˆê¸°í™”ê°€ ë˜ì§€ ì•Šìœ¼ë©´ ë‹¤ìŒ í•™ìŠµì— ì˜í–¥ì„ ì£¼ê¸° ë•Œë¬¸ì— ì˜¬ë°”ë¥¸ í•™ìŠµì´ ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
</code></pre></div></div>

<p><br />
<br />
<br />
<br /></p>

<h1 id="-ë°ì´í„°ë¥¼-ë¶ˆëŸ¬ì˜¤ì-dataset--dataloader">âœ… [ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ì~] Dataset &amp; Dataloader</h1>
<p>ëª¨ë¸ë„ ì¤‘ìš”í•˜ì§€ë§Œ, ë°ì´í„°ë¥¼ ì–´ë–»ê²Œ ì˜ ë‹¤ë£¨ëŠëƒë„ ì¤‘ìš”í•©ë‹ˆë‹¤. ì—„ì²­ë‚˜ê²Œ ë§ì€ ë°ì´í„°ê°€ ìˆìŠµë‹ˆë‹¤. ì´ê²ƒì„ ì–´ì°Œí•´ì•¼ í• ê¹Œìš”? ìš°ë¦¬ì—ê² íŒŒì´í† ì¹˜ê°€ ìˆìŠµë‹ˆë‹¤.</p>

<h2 id="pytorch-dataset">Pytorch Dataset</h2>
<p>ë¨¼ì € ë°ì´í„°ë¥¼ í…ì„œë¡œ ë°”ê¾¸ê³  DataLoder ë¡œ ëª¨ë¸ì— ë¨¹ì´ê¸°(Feeding)</p>
<ol>
  <li>ë°ì´í„° ëª¨ìœ¼ê¸°</li>
  <li>data ë°›ê¸°</li>
  <li>transform : ë°ì´í„° ì „ì²˜ë¦¬
    <ul>
      <li>ToTensor()</li>
      <li>CenterCrop()</li>
    </ul>
  </li>
</ol>

<p>íŒŒì´í† ì¹˜ì˜ DataSetì„ ì‚¬ìš©í•¨ìœ¼ë¡œì¨ ë§ì€ ì¥ì ì„ ê°€ì§„ë‹¤.</p>

<p>CustomDataset ì™€ì˜ ê²°í•©í•´ë´…ì‹œë‹¤. CustomDatasetì„ ì •ì˜ í•˜ê¸° ìœ„í•´ì„œ 3ê°œì˜ ë©”ì†Œë“œë¥¼ ë°˜ë“œì‹œ ì •ì˜í•´ì•¼ í•©ë‹ˆë‹¤.</p>

<ul>
  <li>init</li>
  <li>len</li>
  <li>getitem</li>
</ul>

<p>utils.data.Dataset ìƒì†
ì´ë•Œ Datase$$t í´ë˜ìŠ¤ ì‚¬ìš©</p>

<h2 id="pytorch-dataloader">Pytorch Dataloader</h2>
<p>ì´ì œ DataLoder ëª¨ë“ˆì„ ë°°ì›Œë´…ì‹œë‹¤. CustomDataset, ê¸°íƒ€ ì˜µì…˜ìœ¼ë¡œ ì‹¤ì œ ë°ì´í„°ì— ì ìš©í•˜ë©´ ë©ë‹ˆë‹¤. ì˜µì…˜ìœ¼ë¡œ ë‹¤ì–‘í•œ ê²ƒì´ ìˆìŠµë‹ˆë‹¤. ë¯¸ë‹ˆë°°ì¹˜ ì‚¬ì´ì¦ˆ ë“±ì´ ìˆê² ì£ . ì½”ë“œë¥¼ ì§ì ‘ ëœ»ìœ¼ë©´ì„œ DataLoaderë¥¼ í•´ë³´ì„¸ìš”.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ì‹¤ì „ ì—°ìŠµ
Mnist í´ë¡  ì½”ë”©ì„ í•´ë³´ì„¸ìš”.
</code></pre></div></div>

<p><br />
<br />
<br />
<br /></p>

<h1 id="-save-model-ëª¨ë¸ì„-ì €ì¥í•˜ê³ -ë¶ˆëŸ¬ì˜¤ê¸°">âœ… [Save Model] ëª¨ë¸ì„ ì €ì¥í•˜ê³  ë¶ˆëŸ¬ì˜¤ê¸°</h1>
<p>ìš°ë¦¬ëŠ” ì‹¤ì œ ë¼ë²¨ê³¼ ì˜ˆì¸¡ ë¼ë²¨ì˜ ì˜¤ì°¨ í•¨ìˆ˜ì˜ ê·¸ë ˆë””ì–¸íŠ¸ë¥¼ ê³„ì‚°í•˜ê³  ì˜¤ì°¨ì—­ì „íŒŒë¥¼ ê³„ì‚°í•˜ì—¬ W ê°€ì¤‘ì¹˜ í…ì„œë¥¼ ì—…ë°ì´íŠ¸ ì‹œì¼°ë‹¤ê³  ê°€ì •í•©ë‹ˆë‹¤. ìš°ë¦¬ëŠ” ì´ ê²°ê³¼ë¥¼ ì „ë‹¬í•˜ë ¤ í•œë‹¤.<strong>ì–´ë–»ê²Œ</strong> í•˜ëŠ”ê²Œ ì¢‹ì„ê¹Œìš” ?</p>

<p><code class="language-plaintext highlighter-rouge">model.save()</code> í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•©ì‹œë‹¤. 
ì´ë¥¼ ì´ìš©í•´ì„œ ëª¨ë¸ì˜ í˜•íƒœì™€ íŒŒë¼ë©”í„°ë¥¼ ì €ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<p>ì €ì¥ë²• 2ê°€ì§€ê°€ ìˆìŠµë‹ˆë‹¤.</p>

<ol>
  <li>íŒŒë¼ë©”í„°ë§Œ ì €ì¥</li>
  <li>ëª¨ë¸í˜•í…Œ + íŒŒë¼ë©”í„° ì €ì¥</li>
</ol>

<h2 id="check-point">check point</h2>
<p>ì¤‘ê°„ì¤‘ê°„ì— loss ì™€ metricì„ ì§€ì†ì ìœ¼ë¡œ ì €ì¥í•˜ëŠ” ê²ƒì„ ë§í•©ë‹ˆë‹¤. ì½”ë“œ ì¤‘ê°„ì— pickle í˜•íƒœë¡œ ì €ì¥í•˜ì„¸ìš”. ì¤‘ê°„ì— Earlystopping(ì¡°ê¸° ì¢…ë£Œ) ì²˜ë¦¬ë¥¼ í•  ìˆ˜ ë„ ìˆìŠµë‹ˆë‹¤.</p>

<h2 id="ì „ì´í•™ìŠµê³¼-ë¶ˆëŸ¬ì˜¤ê¸°">ì „ì´í•™ìŠµê³¼ ë¶ˆëŸ¬ì˜¤ê¸°</h2>
<p>ì „ì´í•™ìŠµ(Transfer learning) ì„ ìœ„í•´ êµ¬ê¸€, í˜ì´ìŠ¤ë¶ì—ì„œ í•™ìŠµí•œ ëª¨ë¸ì„ ê°€ì ¸ì˜¤ë ¤ê³  í•©ë‹ˆë‹¤. ì–´ë–»ê²Œ í• ê¹Œìš”?  NLP ë¶„ì•¼ì—ì„œëŠ” <code class="language-plaintext highlighter-rouge">Huggingface</code>ê°€ ëŒ€í‘œì ì…ë‹ˆë‹¤.  <code class="language-plaintext highlighter-rouge">Freezing</code> ëŠ” Transfer ë¥¼ ì ìš©ì‹œí‚¤ê¸° ìœ„í•´ì„œ ì¼ë¶€ë¶„ì˜ ê°€ì¤‘ì¹˜ë¥¼ í•™ìŠµ ì‹œí‚¤ì§€ ì•ŠëŠ”ê²ƒì„ ë§í•©ë‹ˆë‹¤. íŠ¸ëœìŠ¤í¼ ëŸ¬ë‹ì€ ì™¸ë¶€ ëª¨ë“ˆì—ì„œ ì „ì´í•™ìŠµì„ ê°€ì ¸ì˜¤ê³  ìì‹ ë§Œì˜ layerë¥¼ ì¶”ê°€ ì‹œì¼œ í•™ìŠµì‹œí‚¤ëŠ” ë°©ì‹ìœ¼ë¡œ í•˜ë©´ ë©ë‹ˆë‹¤. êµ‰ì¥íˆ ë§ì´ ì“°ë‹ˆ ì§‘ì¤‘í•´ì„œ ê³µë¶€í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.</p>

<h2 id="freezing">Freezing</h2>
<p>pretrained model í™œìš©ì‹œ ëª¨ë¸ì˜ ì¼ë¶€ë¶„ì„ frozen ì‹œí‚µë‹ˆë‹¤.</p>

<p><br />
<br />
<br />
<br /></p>

<h1 id="-ëª¨ë‹ˆí„°ë§-í•©ì‹œë‹¤---monitoring-tools-for-pytorch">âœ… ëª¨ë‹ˆí„°ë§ í•©ì‹œë‹¤ - Monitoring tools for PyTorch</h1>

<p><code class="language-plaintext highlighter-rouge">Logging</code>ì´ë€ í•™ìŠµì´ ì§„í–‰ë˜ë©´ì„œ ì£¼ìš”í•˜ë‹¤ê³  ìƒê°ë˜ëŠ” ì§€í‘œë“¤ì´ë‚˜ í•™ìŠµì˜ ìƒíƒœ ë“± ê´€ë ¨ëœ ì •ë³´ë“¤ì„ ê¸°ë¡í•˜ëŠ” ê²ƒì„ ë§í•©ë‹ˆë‹¤.</p>

<p><code class="language-plaintext highlighter-rouge">Tensorboard</code>ëŠ” TensorFlowì˜ í”„ë¡œì íŠ¸ë¡œ ë§Œë“¤ì–´ì§„ ì‹œê°í™” ë„êµ¬ë¡œ í•™ìŠµ ê·¸ë˜í”„, Metric, í•™ìŠµ ê²°ê³¼ì˜ ì‹œê°í™”ë¥¼ ì§€ì›í•©ë‹ˆë‹¤.</p>

<p><code class="language-plaintext highlighter-rouge">Weight, Biases</code>ëŠ” ë¨¸ì‹ ëŸ¬ë‹ ì‹¤í—˜ì„ ì›í™œí•˜ê²Œ ì§€ì›í•˜ê¸° ìœ„í•œ ìƒìš© ë„êµ¬ë¡œì¨, í˜‘ì—…, code versioning, ì‹¤í—˜ ê²°ê³¼ ê¸°ë¡ ë“±ì˜ ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ” ì‹œê°í™” íˆ´ì„ ë§í•©ë‹ˆë‹¤.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
import os
logs_base_dir = 'logs'
os.makedirs(logs_base_dir, exist_ok=True)

from torch.utils.tensorboard import SummaryWriter
import numpy as np

exp = f"{logs_base_dir}/ex3"
writer = SummaryWriter(exp)
for n_iter in range(100):
  writer.add_scalar('Loss/train', np.random.random(), n_iter)
  writer.add_scalar('Loss/test', np.random.random(), n_iter)
  writer.add_scalar('Accuracy/train', np.random.random(), n_iter)  
  writer.add_scalar('Accuracy/test', np.random.random(), n_iter)
writer.flush()

%load_ext tensorboard
%tensorboard --logdir {"logs"}

</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># ë¶„í¬ë¥¼ ë³¸ë‹¤.

from torch.utils.tensorboard import SummaryWriter
import numpy as np
writer = SummaryWriter(logs_base_dir)
for i in range(10):
  x = np.random.random(1000)
  writer.add_histogram('distribution centers', x+i, i)
writer.close()

</code></pre></div></div>

<p><br />
<br />
<br />
<br /></p>

<h1 id="-muti-gpu">âœ… Muti-GPU</h1>

<p><br />
<br />
<br />
<br /></p>

<h1 id="-hyperparameter-tuning">âœ… Hyperparameter Tuning</h1>
<p>ì œëŒ€ë¡œ í•™ìŠµí•˜ê¸° ìœ„í•´ì„  í•˜ì´í¼ íŒŒë¼ë©”í„° íŠœë‹ì„ í•´ì•¼ í•©ë‹ˆë‹¤. í•˜ì´í¼ íŒŒë¼ë©”í‹°ëŠ” dl ì´ í•™ìŠµí•˜ì§€ ì•ŠëŠ” ë³€ìˆ˜ê°’ì´ì£ .</p>

<ul>
  <li>í•™ìŠµë¥ (Learning rate)</li>
  <li>ìµœì í™” í•¨ìˆ˜(Optimizer)</li>
  <li>ì†ì‹¤ í•¨ìˆ˜(Loss Fucnction)</li>
</ul>

<p>ì˜ ì •ë¦¬í•˜ê³  ì˜ ë³€ìˆ˜ë¥¼ ì¡°ì •í•´ì•¼ í•©ë‹ˆë‹¤. ë°ì´í„°ì™€ ëª¨ë¸ì„ ìˆ˜ì •í•´ì„œ ì„±ëŠ¥ì„ í–¥ìƒí•˜ëŠ” ê²ƒì´ ê°€ì¥ ë¹ ë¥´ê¸´ í•˜ì§€ë§Œ í•˜ì´í¼ íŒŒë¼ë©”í„°ë¥¼ íŠœë‹í•˜ëŠ” í˜ì€ ë¶„ëª… í•„ìš”í•©ë‹ˆë‹¤. ìš”ì¦˜ë“¤ì–´ì„œëŠ” ê·¸ë ‡ê²Œ ë§ì´í•˜ëŠ” ì¶”ì„¸ëŠ” ì•„ë‹™ë‹ˆë‹¤. ì•„ë˜ ë‘ ê°€ì§€ ë°©ë²•ì´ ìˆìŠµë‹ˆë‹¤.</p>

<ul>
  <li>Grid LayOut
    <ul>
      <li>ê· ì¼ì ìœ¼ë¡œ íŒŒë¼ë©”í„°ë¥¼ ë³€í™”ì‹œì¼œë‚˜ê°€ëŠ” ë°©ë²•</li>
    </ul>
  </li>
  <li>Random LayOut
    <ul>
      <li>ëœë¤ì ìœ¼ë¡œ íŒŒë¼ë©”í„°ë¥¼ ë³€í™”ì‹œì¼œë‚˜ê°€ëŠ” ë°©ë²•</li>
    </ul>
  </li>
</ul>

<p>RayëŠ” ë©€í‹° ë…¸ë“œ ë©€í‹° í”„ë¡œì„¸ìŠ¤ ì§€ì› ëª¨ë“ˆì´ë‹¤. ë¶„ì‚°ë³‘ë ¹ ml/dl ì˜ í‘œì¤€ì´ë¼ í•  ìˆ˜ ìˆë‹¤.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>í•˜ì´í¼ íŒŒë¼ë©”í„° íŠœë‹ì€ ì–´ëŠì •ë„ í•™ìŠµ ëª¨ë¸ì„ ì™„ì „í•˜ê²Œ ë§Œë“¤ì–´ ë†“ê³  ìˆ˜ì •í•˜ëŠ” ê²ƒì„ ì¶”ì²œí•©ë‹ˆë‹¤. ë°ì´í„°ì™€ ëª¨ë¸ì— ì§‘ì¤‘í•˜ì„¸ìš”.
</code></pre></div></div>

<p><br />
<br />
<br />
<br /></p>

<h1 id="-pytorch-troubleshooting">âœ… PyTorch Troubleshooting</h1>
<p>OOM(Out Of Memory) ë€ ë¬´ì—‡ì¼ê¹Œìš”. GPU ë©”ëª¨ë¦¬ ì˜¤ë¥˜ë¥¼ ë§í•©ë‹ˆë‹¤. 
ì´ë¥¼ ë°©ì§€í•˜ëŠ” ë°©ë²•ì€ ë‘ê°€ì§€ê°€ ìˆìŠµë‹ˆë‹¤. í•˜ë‚˜ëŠ” batchSizeë¥¼ ì¤„ì´ëŠ” ê²ƒì´ê³ , ë‘˜ì§¸ëŠ” memoryë¥¼ ì¤„ì´ëŠ” ë°©ë²•ì…ë‹ˆë‹¤. <code class="language-plaintext highlighter-rouge">GPUutil</code> ëª¨ë“ˆì„ ì‚¬ìš©í•˜ì„¸ìš”. ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” gpu cache ë¥¼ ì‚­ì œí•´ì•¼ í•©ë‹ˆë‹¤. <code class="language-plaintext highlighter-rouge">torch.no_grad()</code> ë¥¼ ì‚¬ìš©ë„ ì¢‹ìŠµë‹ˆë‹¤. tensorì˜ float precisionì„ ì¤„ì—¬ë„ ëœë‹¤.</p>

<p>í•˜ì§€ë§Œ ê²°êµ­ ì¤‘ìš”í•œ ê²ƒì€ ë°œìƒí•  ë•Œë§ˆë‹¤ ì§ì ‘ íŠ¸ëŸ¬ë¸” ìŠˆíŒ…ì„ ë‹¤ë£¨ëŠ” ëŠ¥ë ¥ì…ë‹ˆë‹¤.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ë°‘ë°”ë‹¥ ë¶€í„° ì‹œì‘í•˜ëŠ” ë”¥ëŸ¬ë‹ 3 ì¶”ì²œí•©ë‹ˆë‹¤.
</code></pre></div></div>

<p><br />
<br />
<br />
<br /></p>


        
      </section>

      <footer class="page__meta">
        
        <!--Archive page ìš©-: (post -> page)-->
<!--page__taxonomy.htmlì—ì„œ ê°€ì ¸ ì˜´-->
        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> ì—…ë°ì´íŠ¸:</strong> <time class="dt-published" datetime="2023-03-07">March 7, 2023</time></p>

      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">ê³µìœ í•˜ê¸°</h4>
  

  <a href="https://twitter.com/intent/tweet?text=Pytorch+%20http%3A%2F%2Flocalhost%3A4000%2Fa04_aitech_knowledge%2Fpost-pytorch%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="ê³µìœ í•˜ê¸° Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2Fa04_aitech_knowledge%2Fpost-pytorch%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="ê³µìœ í•˜ê¸° Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2Fa04_aitech_knowledge%2Fpost-pytorch%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="ê³µìœ í•˜ê¸° LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/a04_aitech_knowledge/post-python/" class="pagination--pager" title="Python ì •ë¦¬
">ì´ì „</a>
    
    
      <a href="/a02_aitech_daily/post-day03/" class="pagination--pager" title="a01_study tech -Day03
">ë‹¤ìŒ</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h2 class="page__related-title">ì°¸ê³ </h2>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/a03_aitech_weekly/post-11%EC%A3%BC%EC%B0%A8/" rel="permalink"
        style="
            color: #E90064;
            font-size: 1.4em;
            font-weight: bold;
            /*background: #F7C04A;*/
            "
        >[a01_study tech 5ê¸°] [íšŒê³ ] 11ì£¼ì°¨ë¥¼ ë³´ë‚´ë©°â€¦
 </a>
      <small>
        <i class="fas fa-fw fa-calendar-alt" aria-hidden="true"> </i> 2023.05.19
        
      </small>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          ìµœëŒ€ 1 ë¶„ ì†Œìš”
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">
</p>
  </article>
</div>


<style>
a:link {
  text-decoration: none;
}

a:visited {
  text-decoration: none;
}

a:hover {
  text-decoration: underline;
}

a:active {
  text-decoration: underline;
}
</style>
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/a03_aitech_weekly/post-10%EC%A3%BC%EC%B0%A8/" rel="permalink"
        style="
            color: #E90064;
            font-size: 1.4em;
            font-weight: bold;
            /*background: #F7C04A;*/
            "
        >[a01_study tech 5ê¸°] [íšŒê³ ] 10ì£¼ì°¨ë¥¼ ë³´ë‚´ë©°â€¦
 </a>
      <small>
        <i class="fas fa-fw fa-calendar-alt" aria-hidden="true"> </i> 2023.05.12
        
      </small>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          ìµœëŒ€ 1 ë¶„ ì†Œìš”
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">
</p>
  </article>
</div>


<style>
a:link {
  text-decoration: none;
}

a:visited {
  text-decoration: none;
}

a:hover {
  text-decoration: underline;
}

a:active {
  text-decoration: underline;
}
</style>
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/a03_aitech_weekly/post-9%EC%A3%BC%EC%B0%A8/" rel="permalink"
        style="
            color: #E90064;
            font-size: 1.4em;
            font-weight: bold;
            /*background: #F7C04A;*/
            "
        >[a01_study tech 5ê¸°] [íšŒê³ ] 9ì£¼ì°¨ë¥¼ ë³´ë‚´ë©°â€¦
 </a>
      <small>
        <i class="fas fa-fw fa-calendar-alt" aria-hidden="true"> </i> 2023.05.04
        
      </small>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          ìµœëŒ€ 1 ë¶„ ì†Œìš”
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">
</p>
  </article>
</div>


<style>
a:link {
  text-decoration: none;
}

a:visited {
  text-decoration: none;
}

a:hover {
  text-decoration: underline;
}

a:active {
  text-decoration: underline;
}
</style>
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/a03_aitech_weekly/post-8%EC%A3%BC%EC%B0%A8/" rel="permalink"
        style="
            color: #E90064;
            font-size: 1.4em;
            font-weight: bold;
            /*background: #F7C04A;*/
            "
        >[a01_study tech 5ê¸°] [íšŒê³ ] 8ì£¼ì°¨ë¥¼ ë³´ë‚´ë©°â€¦
 </a>
      <small>
        <i class="fas fa-fw fa-calendar-alt" aria-hidden="true"> </i> 2023.04.28
        
      </small>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          ìµœëŒ€ 1 ë¶„ ì†Œìš”
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">
</p>
  </article>
</div>


<style>
a:link {
  text-decoration: none;
}

a:visited {
  text-decoration: none;
}

a:hover {
  text-decoration: underline;
}

a:active {
  text-decoration: underline;
}
</style>
        
      </div>
    </div>
  
  
</div>

    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>íŒ”ë¡œìš°:</strong></li>
    

    
      
        
          <li><a href="https://github.com/yunjinchoidev" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> í”¼ë“œ</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2023 ìì—°ì–´ ì²˜ë¦¬ ì—”ì§€ë‹ˆì–´ ë¸”ë¡œê·¸. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>






<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-KNC4SPLJPV"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-KNC4SPLJPV');
</script>


    
  <script>
    var disqus_config = function () {
      this.page.url = "http://localhost:4000/a04_aitech_knowledge/post-pytorch/";  /* Replace PAGE_URL with your page's canonical URL variable */
      this.page.identifier = "/a04_aitech_knowledge/post-pytorch"; /* Replace PAGE_IDENTIFIER with your page's unique identifier variable */
    };
    (function() { /* DON'T EDIT BELOW THIS LINE */
      var d = document, s = d.createElement('script');
      s.src = 'https://yunjinchoidev-github-io.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


  





  </body>
</html>
